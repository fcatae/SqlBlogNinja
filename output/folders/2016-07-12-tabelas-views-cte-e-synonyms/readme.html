<a link='https://blogs.msdn.microsoft.com/fcatae/2016/07/12/tabelas-views-cte-e-synonyms/'>Tabelas, Views, CTE e Synonyms</a>
<p>View é um dos recursos mais poderosos do banco de dados relacional. Podemos usar as Views como sinônimos de tabela, facilitando o acesso aos dados. Por exemplo, vamos usar uma tabela de usuário definida com dois campos:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image357.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb254.png" width="310" height="109"></a></p> <p>Poderíamos simplificar a definição da tabela usando uma view:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image358.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb255.png" width="398" height="141"></a></p> <p>Assim, podemos acessar a tabela de usuários diretamente pela tabela ou através da View:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image359.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb256.png" width="365" height="278"></a></p> <p>O desempenho é praticamente idêntico entre as duas consultas, pois a View é somente uma “definição”. Se você tiver curiosidade, pode olhar a DMV sys.dm_exec_cached_plans e observar que a View é armazenada como uma árvore sintática (parse tree) ao invés de um plano de execução (compiled plan). </p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image360.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb257.png" width="320" height="33"></a></p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image363.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb258.png" width="531" height="138"></a></p> <p>&nbsp;</p> <p>Podemos usar a View para realizar operações DML. Por exemplo, vamos inserir registros na tabela:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image364.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb259.png" width="335" height="62"></a></p> <p>WOW!!! Note que estou inserindo registros na tabela “tabela_usuarios” usando a view “vwUsuarios”, assim como poderia ter executado outros comandos DML (UPDATE e DELETE) na view.</p> <p>&nbsp;</p> <h3>Common Table Expression (CTE)</h3> <p>Muitos já ouviram falar sobre as CTE, também conhecidas como Common Table Expression. Gosto de pensar que as CTE são as “Inline-View” e, portanto, seria equivalente realizar o seguinte comando:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image365.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb260.png" width="400" height="174"></a></p> <p>Esse único comando define uma expressão chamada “cteUsu” que existe somente no contexto da execução do SELECT. É semelhante a View, pois representa apenas uma definição. É diferente porque a definição é temporária, sem necessidade de guardar o metadado. O desempenho é igual a usar o acesso a uma tabela ou a view. </p> <p>&nbsp;</p> <h3>Synonyms</h3>    <p>Sinônimo é a forma mais fácil de “renomear” um objeto. Eu posso usar um sinônimo para a tabela de usuários:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image366.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb261.png" width="345" height="52"></a></p> <p>        <p>Nesse caso não é possível redefinir o nome dos campos e o SELECT retorna os campos iguais a definição da tabela.</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image367.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb262.png" width="295" height="151"></a></p> <p>Por outro lado, podemos criar sinônimos para Stored Procedures e Functions. A parte mais divertida do sinônimo é que podemos referenciar objetos em outros banco de dados (inclusive em outros servidores, se usarmos Linked Server).</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image368.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb263.png" width="484" height="180"></a></p> <p>&nbsp;</p></p>  <h3>Conclusão</h3> <p>Esse artigo dá início a série “Another point of VIEW” com o objetivo de revelar uma perspectiva diferente sobre as Views. Assim como elas resolvem problemas, elas também escondem algumas armadilhas.</p> <p>Nos próximos artigos, abordarei a diferença entre View e Function.</p>
