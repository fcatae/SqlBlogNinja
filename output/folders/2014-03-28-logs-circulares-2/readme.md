<a link='https://blogs.msdn.microsoft.com/fcatae/2014/03/28/logs-circulares-2/'>Logs Circulares 2</a>
<p>Encontrei um exemplo nos meus arquivos. Não sei exatamente quem me passou ou se encontrei no documento de performance, mas vou deixar registrado no blog. Frequentemente utilizo o script para lembrar da sintaxe do XQuery e da conversão de timestamp.</p>  <blockquote>   <p><font face="Consolas">SELECT CONVERT (varchar(30), GETDATE(), 121) as runtime,       <br /> DATEADD (ms, -1 * (sys.ms_ticks - a.[Record Time]), GETDATE()) AS Notification_time,&#160; <br />&#160; a.* , sys.ms_ticks AS [Current Time]        <br />&#160; FROM         <br />&#160; (SELECT x.value('(//Record/ResourceMonitor/Notification)[1]', 'varchar(30)') AS [Notification_type],         <br />&#160; x.value('(//Record/MemoryRecord/MemoryUtilization)[1]', 'bigint') AS [MemoryUtilization %],         <br />&#160; x.value('(//Record/MemoryRecord/TotalPhysicalMemory)[1]', 'bigint') AS [TotalPhysicalMemory_KB],         <br />&#160; x.value('(//Record/MemoryRecord/AvailablePhysicalMemory)[1]', 'bigint') AS [AvailablePhysicalMemory_KB],         <br />&#160; x.value('(//Record/MemoryRecord/TotalPageFile)[1]', 'bigint') AS [TotalPageFile_KB],         <br />&#160; x.value('(//Record/MemoryRecord/AvailablePageFile)[1]', 'bigint') AS [AvailablePageFile_KB],         <br />&#160; x.value('(//Record/MemoryRecord/TotalVirtualAddressSpace)[1]', 'bigint') AS [TotalVirtualAddressSpace_KB],         <br />&#160; x.value('(//Record/MemoryRecord/AvailableVirtualAddressSpace)[1]', 'bigint') AS [AvailableVirtualAddressSpace_KB],         <br />&#160; x.value('(//Record/MemoryNode/@id)[1]', 'bigint') AS [Node Id],         <br />&#160; x.value('(//Record/MemoryNode/ReservedMemory)[1]', 'bigint') AS [SQL_ReservedMemory_KB],         <br />&#160; x.value('(//Record/MemoryNode/CommittedMemory)[1]', 'bigint') AS [SQL_CommittedMemory_KB],         <br />&#160; x.value('(//Record/@id)[1]', 'bigint') AS [Record Id],         <br />&#160; x.value('(//Record/@type)[1]', 'varchar(30)') AS [Type],         <br />&#160; x.value('(//Record/ResourceMonitor/Indicators)[1]', 'bigint') AS [Indicators],         <br />&#160; x.value('(//Record/@time)[1]', 'bigint') AS [Record Time]        <br />&#160; FROM (SELECT CAST (record as xml) FROM sys.dm_os_ring_buffers         <br />&#160; WHERE ring_buffer_type = 'RING_BUFFER_RESOURCE_MONITOR') AS R(x)) a         <br /> CROSS JOIN sys.dm_os_sys_info sys        <br /> ORDER BY a.[Record Time] ASC</font></p> </blockquote>  <p>Tenho mais um script utilizando XEvent gravando os registros no Ring Buffers. Vou procurar e postar em seguida.   </p>
