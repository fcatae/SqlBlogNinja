<a link='https://blogs.msdn.microsoft.com/fcatae/2016/07/26/desafio-delete-1000-linhas/'>Desafio: DELETE 1000 Linhas</a>
<p>Esse é o primeiro desafio da Série “Another point of VIEW”, na qual abordamos o uso de Views.</p> <p>A situação é comum e ocorre em várias aplicações. Temos uma tabela que armazena um grande volume de dados.</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image379.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb274.png" width="426" height="156"></a></p> <p>Em seguida, populamos a tabela com 10000 linhas:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image380.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb275.png" width="430" height="61"></a></p>   <p>Esse tipo de tabela normalmente cresce rapidamente com muitos dados e, por isso, periodicamente é necessário apagar os registros. Entretanto, vamos apagar somente os 1000 registros mais antigos.</p> <p>Uma forma seria escrever esse comando:</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image382.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb276.png" width="514" height="84"></a></p> <p>O plano de execução é complexo e tem custo 0.83 para apenas 10000 registros. Se fossem milhões de registros, o custo aumentaria e o comando ficaria executando por minutos.</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image383.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb277.png" width="638" height="133"></a></p> <p>&nbsp;</p> <h3>Como você otimizaria essa consulta?</h3> <p>Essa query é um problema!</p> <p>Será que adianta adicionar índices?</p> <p>Será que reescrever resolve?</p> <p><a href="https://msdnshared.blob.core.windows.net/media/2016/06/image384.png"><img title="image" style="border-top: 0px;border-right: 0px;border-bottom: 0px;padding-top: 0px;padding-left: 0px;border-left: 0px;margin: 0px;padding-right: 0px" border="0" alt="image" src="https://msdnshared.blob.core.windows.net/media/2016/06/image_thumb278.png" width="447" height="55"></a></p> <p>Resposta no próximo artigo.</p>
