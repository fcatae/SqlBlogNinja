<a link='https://blogs.msdn.microsoft.com/fcatae/2010/10/30/a-significant-part-of-sql-server-process-memory-has-been-paged-out/'>A significant part of sql server process memory has been paged out</a>
<h2>Ouch! Você sabe o que essa mensagem significa?</h2>  <blockquote>   <p><em><strong>2010-10-31</strong> <strong>12:00:00.00</strong> spid1s&#160;&#160;&#160;&#160;&#160; A significant part of sql server process memory has been paged out. This may result in a performance degradation. Duration: 0 seconds. Working set (KB): 4620, committed (KB): 1652332, memory utilization: 0%.</em></p> </blockquote>  <p>Pensando na data, dia 31/Out, eu seriamente pensaria em Helloween! Porque essa mensagem indica um grande problema no SQL Server.</p>  <blockquote>   <p><strong>Artigos relacionados</strong></p> </blockquote>  <blockquote>   <p><a href="http://blogs.msdn.com/b/fcatae/archive/2009/09/02/resource-monitor-notifica-es.aspx" target="_blank">Resource Monitor – Notificações</a></p>    <p><a href="http://blogs.msdn.com/b/fcatae/archive/2010/03/31/memory-working-set.aspx" target="_blank">Working Set</a></p>    <p><a href="http://blogs.msdn.com/b/fcatae/archive/2010/04/20/shared-memory.aspx" target="_blank">Shared Memory</a></p> </blockquote>  <blockquote>   <p><a href="http://blogs.msdn.com/b/fcatae/archive/2010/10/18/desafio-resource-monitor-paginacao-memoria.aspx">Desafio: Resource Monitor e Paginação de Memória</a></p>    <p>&#160;</p> </blockquote>  <h2>Problema</h2>  <p>O princípio do SQL Server é utilizar a maior parte da memória como <a href="http://blogs.msdn.com/b/fcatae/archive/2010/06/25/cache-de-dados.aspx" target="_blank">cache de dados</a>, sendo liberada através do mecanismo de notificação do <a href="http://blogs.msdn.com/b/fcatae/archive/2009/09/02/resource-monitor-notifica-es.aspx" target="_blank">Resouce Monitor</a>. Entretanto, o erro acima está alertando o administrador sobre um problema entre o <strong>SQL Server</strong> e o <strong>Sistema Operacional</strong>:</p>  <blockquote>   <p>A significant part of sql server process memory has been paged out. This may result in a performance degradation. Duration: 0 seconds. <span style="color: #ff0000">Working set (KB): 4620, committed (KB): 1652332, memory utilization: 0%.</span></p> </blockquote>  <p><strong>Tradução: </strong>Observamos que o SQL Server utiliza um total de <font color="#ff0000">1652332KB de memória</font>, no qual apenas <font color="#ff0000">4620KB está em memória RAM</font> (<a href="http://blogs.msdn.com/b/fcatae/archive/2010/03/31/memory-working-set.aspx" target="_blank">Working Set</a>) e o restante de 1683662KB se encontra no Page File. Em porcentagem, isso corresponde a uma <font color="#ff0000">utilização de memória RAM (memory utilization) igual a 0%</font> – o ideal é que isso se mantenha sempre em 100%.</p>  <p>Isso é um comportamento anormal. A memória de cache está gravada em disco e, portanto, há um impacto direto na performance do servidor (cache combina com memória, não com disco). Como resultado disso, é comum encontrar erros de travamento do Scheduler, falhas de conexão com o banco de dados, lentidão inexplicável, etc… qualquer erro estilo Helloween é esperado. </p>  <p>Se você se deparar com esse erro no servidor, aja rápido antes que apareçam suas consequências.</p>  <p>&#160;</p>  <h2>Como resolver?</h2>  <p>Existe uma receita bastante simples para evitar esse tipo de problema. A primeira ação a ser tomada é revisar o limite máximo de memória usada pelo SQL Server, estabelecendo limites menores. Por exemplo, podemos limitar o uso de apenas 1GB ao SQL Server.</p>  <p><span style="font-family: courier new;color: #0000ff;font-size: x-small"></span>    <blockquote>     <p align="left">EXEC <span style="font-family: courier new;color: #800000">sp_configure</span><span style="font-family: courier new;color: #0000ff"> </span><span style="font-family: courier new;color: #ff0000">'advanced option<span style="font-family: courier new;color: #ff0000">'</span></span><span style="font-family: courier new;color: #808080">,</span><span style="font-family: courier new;color: #000000"> 1</span> </p>     <span style="font-size: x-small"><span style="font-family: courier new;color: #0000ff">RECONFIGURE</span> </span>      <p align="left"><span style="font-size: x-small">EXEC <span style="font-family: courier new;color: #800000">sp_configure</span><span style="font-family: courier new;color: #0000ff"> </span><span style="font-family: courier new;color: #ff0000"><span style="font-family: courier new;color: #ff0000">'</span>max server memory<span style="font-family: courier new;color: #ff0000">'</span></span><span style="font-family: courier new;color: #808080">,</span><span style="font-family: courier new;color: #000000"> 1000</span> </span></p>      <p align="left"><span style="font-family: courier new;color: #0000ff"><span style="font-size: x-small">RECONFIGURE</span></span></p>   </blockquote> </p>    <p>O segundo passo é garantir que a memória do SQL Server não será paginada através da opção <a href="http://blogs.msdn.com/b/fcatae/archive/2010/07/02/lock-pages-in-memory.aspx" target="_blank">Lock Pages in Memory</a>.</p>  <blockquote>   <p><img src="images\1067.image_2.png" width="414" height="332" /></p> </blockquote>  <p>Dessa forma, o SQL Server ficará sempre em memória RAM e não vai paginar para disco.</p>  <p>&#160;</p>  <h2>Basta isso para resolver?</h2>  <p>Não. O mais importante é determinar a causa pelo qual o Sistema Operacional decidiu paginar a memória do SQL Server para disco. O problema mais comum é o alto consumo de memória por:</p>  <ul>   <li>Driver do Sistema Operacional (ex: driver da placa de rede) </li>    <li>Alto consumo de memória por um processo externo ao SQL Server (ex: anti-virus, software de monitoração) </li>    <li>Alto consumo interno ao SQL Server (ex: extended stored procedures, CLR) </li> </ul>
