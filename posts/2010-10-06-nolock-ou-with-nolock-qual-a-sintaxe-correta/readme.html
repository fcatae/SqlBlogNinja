<a link='https://blogs.msdn.microsoft.com/fcatae/2010/10/06/nolock-ou-with-nolock-qual-a-sintaxe-correta/'>NOLOCK ou WITH (NOLOCK): Qual a sintaxe correta?</a>
<p>A hint “<strong>nolock</strong>” permite que o processador do SQL Server não utilize bloqueios (LOCK) durante a leitura de informações, comportamento denominado de leitura suja. Esse é um truque velho e conhecido do SQL Server 2000 e que muitos desenvolvedores tem utilizado. O objetivo desse post é orientar sobre a a sintaxe correta do NOLOCK.</p>  <blockquote>   <p><strong>Links relacionados</strong></p>    <ul>     <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/10/05/como-usar-select-with-nolock-para-melhorar-a-performance.aspx">Como usar SELECT WITH NOLOCK para melhorar a Performance?</a> </li>      <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/10/06/nolock-ou-with-nolock-qual-a-sintaxe-correta.aspx">Qual a sintaxe correta: NOLOCK ou WITH (NOLOCK)?</a> </li>      <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/10/11/update-with-nolock-como-funciona.aspx">NOLOCK e INSERT/UPDATE/DELETE</a> </li>      <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/10/13/problemas-com-nolock-sql-server.aspx">Problemas com NOLOCK</a> </li>      <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/04/28/efeitos-colaterais-do-with-nolock-parte-i.aspx">Efeitos colaterais do NOLOCK – Parte 1</a> </li>      <li><a href="http://blogs.msdn.com/b/fcatae/archive/2010/06/02/efeitos-colaterais-do-with-nolock-parte-ii.aspx">Efeitos colaterais do NOLOCK – Parte 2</a></li>   </ul> </blockquote>  <p>A palavra ‘WITH’ logo depois o nome da tabela é recomendada, mas opcional:</p> <font color="#0000ff" size="2" face="Courier New">   <blockquote>     <p align="left">SELECT <font color="#808080" size="2" face="Courier New">*</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">FROM</font><font color="#000000" size="2" face="Courier New"> tabela </font><font color="#0000ff" size="2" face="Courier New">WITH </font><font color="#808080" size="2" face="Courier New">(</font><font color="#0000ff" size="2" face="Courier New">NOLOCK</font><font color="#808080" size="2" face="Courier New">) <font color="#008000" size="2" face="Courier New">-- CORRETO</font></font></p>   </blockquote>   <font color="#0000ff" size="2" face="Courier New">     <blockquote>       <p align="left">SELECT <font color="#808080" size="2" face="Courier New">*</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">FROM</font><font color="#000000" size="2" face="Courier New"> tabela</font><font color="#0000ff" size="2" face="Courier New"> </font><font color="#808080" size="2" face="Courier New">(</font><font color="#0000ff" size="2" face="Courier New">NOLOCK</font><font color="#808080" size="2" face="Courier New">) <font color="#008000" size="2" face="Courier New">-- CORRETO</font></font></p>     </blockquote>   </font></font>  <p>Ambos os comandos funcionam com sucesso. Por que então recomendar o uso da palavra opcional ‘WITH’?</p>  <p>&#160;</p>  <p><strong>Motivo 1:</strong> A partir do SQL Server 2005, a sintaxe do NOLOCK ficou mais rigorosa. Múltiplas hints funcionam somente com a palavra WITH. </p> <font color="#0000ff" size="2" face="Courier New">   <blockquote>     <p align="left">SELECT <font color="#808080" size="2" face="Courier New">*</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">FROM</font><font color="#000000" size="2" face="Courier New"> tabela</font><font color="#0000ff" size="2" face="Courier New"> </font><font color="#808080" size="2" face="Courier New">(</font><font color="#0000ff" size="2" face="Courier New">Index</font><font color="#808080" size="2" face="Courier New">=</font><font color="#000000" size="2" face="Courier New">idxSeek</font><font color="#808080" size="2" face="Courier New">,</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">NOLOCK</font><font color="#808080" size="2" face="Courier New">)</font><font color="#000000" size="2" face="Courier New"> </font><font color="#008000" size="2" face="Courier New">-- NAO FUNCIONA</font> </p>      <p align="left"></p>     <font color="#0000ff" size="2" face="Courier New">SELECT</font><font color="#000000" size="2" face="Courier New"> </font><font color="#808080" size="2" face="Courier New">*</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">FROM</font><font color="#000000" size="2" face="Courier New"> tabela </font><font color="#0000ff" size="2" face="Courier New">WITH </font><font color="#808080" size="2" face="Courier New">(</font><font color="#0000ff" size="2" face="Courier New">Index</font><font color="#808080" size="2" face="Courier New">=</font><font color="#000000" size="2" face="Courier New">idxSeek</font><font color="#808080" size="2" face="Courier New">,</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">NOLOCK</font><font color="#808080" size="2" face="Courier New">)</font><font color="#000000" size="2" face="Courier New">&#160;<font color="#008000" size="2" face="Courier New">-- </font></font><font color="#008000" size="2" face="Courier New">CORRETO</font></blockquote> </font>  <p align="left"><strong></strong></p>  <p align="left"><strong>.</strong></p>  <p align="left"><strong>Motivo 2:</strong> E se o desenvolvedor esquecer de colocar os parênteses? Parece piada, mas isso ocorre.</p> <font color="#0000ff" size="2" face="Courier New">   <blockquote>     <p align="left">SELECT <font color="#808080" size="2" face="Courier New">*</font><font color="#000000" size="2" face="Courier New"> </font><font color="#0000ff" size="2" face="Courier New">FROM</font><font color="#000000" size="2" face="Courier New"> tabela NOLOCK </font><font color="#008000" size="2" face="Courier New">-- Criamos um alias para a tabela</font></p>   </blockquote>    <p align="left"></p> </font>  <p>O comportamento é interessante: a query funciona, mas o NOLOCK é <strong><u>ignorado</u></strong>. As pessoas acham que é um BUG do SQL Server. Na realidade, foi apenas erro de digitação.</p>
